{"version":3,"sources":["../src/Body.js"],"names":["UID","Body","data","type","DYNAMIC","shapes","position","create","lastPosition","interpolatedPosition","velocity","acceleration","bounce","maxSpeed","gravity","friction","active","timeScale","boundingBox","boundsDirty","id","collisionMask","canCollide","addShape","shape","indexOf","push","globalBounds","out","lower","x","y","upper","updateBounds","minX","Infinity","minY","maxX","maxY","i","length","box","Math","max","min","set","update","deltaTime","speed","reset","STATIC","KINIMATIC","NONE"],"mappings":"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","file":"Body.js","sourcesContent":["import Vector from './Vector';\nimport AABB from './AABB';\n\nlet UID = 0;\n\nexport default class Body\n{\n\n    constructor(data = {})\n    {\n        this.type = Body.DYNAMIC;\n\n        this.shapes = data.shapes || [];\n\n        this.position = Vector.create();\n        this.lastPosition = Vector.create();\n        this.interpolatedPosition = Vector.create();\n\n        this.velocity = Vector.create();\n        this.acceleration = Vector.create();\n        this.bounce = 0;\n\n        this.maxSpeed = data.maxSpeed || 5;\n\n        this.gravity = data.gravity || 0;//0.1;\n\n        this.friction = data.friction || 0.9;\n\n        this.active = true;\n\n        this.timeScale = 1;\n\n        this.boundingBox = new AABB();\n        this.boundsDirty = true;\n\n        this.id = UID++;\n\n        this.collisionMask = 0;\n\n        this.canCollide = true;\n    }\n\n    addShape(shape)\n    {\n        if(this.shapes.indexOf(shape) === -1)\n        {\n            this.shapes.push(shape);\n        }\n\n        this.boundsDirty = true;\n    }\n\n    globalBounds(out)\n    {\n        const boundingBox = this.boundingBox;\n        const position = this.position;\n\n        out.lower.x = boundingBox.lower.x + position.x;\n        out.lower.y = boundingBox.lower.y + position.y;\n\n        out.upper.x = boundingBox.upper.x + position.x;\n        out.upper.y = boundingBox.upper.y + position.y;\n\n        return out;\n    }\n\n    updateBounds()\n    {\n        this.boundsDirty = false;\n\n        let minX = Infinity;\n        let minY = Infinity;\n\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n\n        for (var i = 0; i < this.shapes.length; i++) {\n\n            const box = this.shapes[i].boundingBox;\n\n            maxX = Math.max(maxX, box.upper.x);\n            maxY = Math.max(maxY, box.upper.y);\n            minX = Math.min(minX, box.lower.x);\n            minY = Math.min(minY, box.lower.y);\n        }\n\n        this.boundingBox.set(minX, minY, maxX, maxY);\n    }\n\n    update(deltaTime)\n    {\n        if(!this.active)return;\n\n        var velocity = this.velocity\n\n        velocity.x += this.acceleration.x * deltaTime;\n        velocity.y += this.acceleration.y * deltaTime;\n\n        // frsition...\n        velocity.y *= this.friction;\n        velocity.x *= this.friction;\n\n        velocity.y += this.gravity * this.timeScale;\n\n        var speed = velocity.length();\n\n        if(speed > 0)\n        {\n            velocity.x /= speed;\n            velocity.y /= speed;\n\n            speed = Math.min(speed,this.maxSpeed);\n\n            velocity.x *= speed;\n            velocity.y *= speed;\n        }\n\n\n        this.position.x += velocity.x * this.timeScale * deltaTime;\n        this.position.y += velocity.y * this.timeScale * deltaTime;\n    }\n\n    reset()\n    {\n        this.velocity.set(0);\n        this.acceleration.set(0);\n\n        this.active = true;\n    }\n}\n\nBody.STATIC = 0;\nBody.KINIMATIC = 1;\nBody.DYNAMIC = 2;\nBody.NONE = 3;\n\n/*\n    getDebugView(color)\n    {\n        var shape = this.shape;\n        var color = color || colors[this.type]\n        return new PIXI.Graphics().beginFill(color).drawRect(shape.x,shape.y,shape.width, shape.height)\n\n    }\n\n    CrashBody.fromRect = function(x, y, w, h){\n\n        return new CrashBody(new PIXI.Rectangle(x,y,w,h));\n    }\n\n    CrashBody.STATIC = 0;\n    CrashBody.KINIMATIC = 1;\n    CrashBody.DYNAMIC = 2;\n    CrashBody.NONE = 3;\n\n    colors = [\n        0x463a78,\n        0xFFFF00,\n        0xFF0000,\n        0x0000FF\n    ]\n    module.exports = CrashBody;\n\n});*/"]}