{"version":3,"sources":["../src/Body.js"],"names":["UID","Body","data","type","DYNAMIC","shapes","position","create","lastPosition","interpolatedPosition","velocity","acceleration","bounce","maxSpeed","gravity","friction","active","timeScale","boundingBox","boundsDirty","id","collisionMask","canCollide","shape","indexOf","push","out","lower","x","y","upper","minX","Infinity","minY","maxX","maxY","i","length","box","Math","max","min","set","deltaTime","speed","STATIC","KINIMATIC","NONE"],"mappings":"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","file":"Body.js","sourcesContent":["import Vector from './Vector';\nimport AABB from './AABB';\n\nlet UID = 0;\n\nexport default class Body\n{\n\n    constructor(data = {})\n    {\n        this.type = Body.DYNAMIC;\n\n        this.shapes = data.shapes || [];\n\n        this.position = Vector.create();\n        this.lastPosition = Vector.create();\n        this.interpolatedPosition = Vector.create();\n\n        this.velocity = Vector.create();\n        this.acceleration = Vector.create();\n        this.bounce = 0;\n\n        this.maxSpeed = data.maxSpeed || 5;\n\n        this.gravity = data.gravity || 0;//0.1;\n\n        this.friction = data.friction || 0.9;\n\n        this.active = true;\n\n        this.timeScale = 1;\n\n        this.boundingBox = new AABB();\n        this.boundsDirty = true;\n\n        this.id = UID++;\n\n        this.collisionMask = 0;\n\n        this.canCollide = true;\n    }\n\n    addShape(shape)\n    {\n        if(this.shapes.indexOf(shape) === -1)\n        {\n            this.shapes.push(shape);\n        }\n\n        this.boundsDirty = true;\n    }\n\n    globalBounds(out)\n    {\n        const boundingBox = this.boundingBox;\n        const position = this.position;\n\n        out.lower.x = boundingBox.lower.x + position.x;\n        out.lower.y = boundingBox.lower.y + position.y;\n\n        out.upper.x = boundingBox.upper.x + position.x;\n        out.upper.y = boundingBox.upper.y + position.y;\n\n        return out;\n    }\n\n    updateBounds()\n    {\n        this.boundsDirty = false;\n\n        let minX = Infinity;\n        let minY = Infinity;\n\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n\n        for (var i = 0; i < this.shapes.length; i++) {\n\n            const box = this.shapes[i].boundingBox;\n\n            maxX = Math.max(maxX, box.upper.x);\n            maxY = Math.max(maxY, box.upper.y);\n            minX = Math.min(minX, box.lower.x);\n            minY = Math.min(minY, box.lower.y);\n        }\n\n        this.boundingBox.set(minX, minY, maxX, maxY);\n    }\n\n    update(deltaTime)\n    {\n        if(!this.active)return;\n\n        var velocity = this.velocity\n\n        velocity.x += this.acceleration.x * deltaTime;\n        velocity.y += this.acceleration.y * deltaTime;\n\n        // frsition...\n        velocity.y *= this.friction;\n        velocity.x *= this.friction;\n\n        velocity.y += this.gravity * this.timeScale;\n\n        var speed = velocity.length();\n\n        if(speed > 0)\n        {\n            velocity.x /= speed;\n            velocity.y /= speed;\n\n            speed = Math.min(speed,this.maxSpeed);\n\n            velocity.x *= speed;\n            velocity.y *= speed;\n        }\n\n\n        this.position.x += velocity.x * this.timeScale * deltaTime;\n        this.position.y += velocity.y * this.timeScale * deltaTime;\n    }\n\n    reset()\n    {\n        this.velocity.set(0);\n        this.acceleration.set(0);\n\n        this.active = true;\n    }\n}\n\nBody.STATIC = 0;\nBody.KINIMATIC = 1;\nBody.DYNAMIC = 2;\nBody.NONE = 3;\n\n/*\n    getDebugView(color)\n    {\n        var shape = this.shape;\n        var color = color || colors[this.type]\n        return new PIXI.Graphics().beginFill(color).drawRect(shape.x,shape.y,shape.width, shape.height)\n\n    }\n\n    CrashBody.fromRect = function(x, y, w, h){\n\n        return new CrashBody(new PIXI.Rectangle(x,y,w,h));\n    }\n\n    CrashBody.STATIC = 0;\n    CrashBody.KINIMATIC = 1;\n    CrashBody.DYNAMIC = 2;\n    CrashBody.NONE = 3;\n\n    colors = [\n        0x463a78,\n        0xFFFF00,\n        0xFF0000,\n        0x0000FF\n    ]\n    module.exports = CrashBody;\n\n});*/"]}